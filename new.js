webpackJsonp([18],{1247:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{versionId:"",currentName:"",currentSectionUnitId:"",courseStructure:null}},props:["courseId","classId","chapterId","unitType","elementId"],components:{},watch:{currentName:function(e,t){this.$emit("nameChange",e)},currentSectionUnitId:function(e,t){this.$emit("sectionChange",e)}},methods:{saveStudyRecord:function(e){this.$http.post("/lms/api/v1/study_record/",{course_id:this.courseId,version_id:this.versionId,item_id:e||this.elementId,type:this.unitType}).then(function(e){e.data.code})},changeVideo:function(e,t,i){this.unitType=i;var n="/video/"+this.courseId+"/"+this.classId+"/"+t+"/"+e+"/"+i+"/";this.$router.push({path:n})},changeGraphic:function(e,t,i){this.currentUnitType=i;var n="/graphic/"+this.courseId+"/"+this.classId+"/"+t+"/"+e+"/"+i+"/";this.$router.push({path:n})},changeHomework:function(e){var t=this;this.$http.post("/lms/api/v1/study_record/",{course_id:this.courseId,version_id:this.versionId,item_id:e,type:1}).then(function(e){0===e.data.code&&t.$router.push({name:"mainSchedule"})})},changeExam:function(e){var t=this,i=window.open("_blank");this.$http.post("/lms/api/v1/study_record/",{course_id:this.courseId,version_id:this.$store.state.courseInfo.version_id,item_id:e,type:2}).then(function(e){0===e.data.code&&(i.location="/exam/"+t.courseId+"/"+t.classId+"/#/exam_list")})},changeChapterShow:function(e){e.fold=!e.fold},changeSectionShow:function(e){e.fold=!e.fold},getData:function(){var e=this;this.$http.post("/lms/api/v1/course/"+this.courseId+"/courseware/",{class_id:this.classId}).then(function(t){0===t.data.code&&(e.$store.commit("courseware",t.data.data),e.courseStructure=t.data.data,e.versionId=t.data.version_id,e.initDefaultShow(t.data.server_time),e.saveStudyRecord())},function(e){})},defaultShow:function(e,t){if(this.courseStructure)for(var i=0;i<this.courseStructure.length;i++)if(this.courseStructure[i].unit_id==t&&this.courseStructure[i].children)for(var n=0;n<this.courseStructure[i].children.length;n++)if(this.courseStructure[i].children[n].items)for(var o=0;o<this.courseStructure[i].children[n].items.length;o++)if(this.courseStructure[i].children[n].items[o].item_id==e)return this.$set(this.courseStructure[i],"fold",!1),this.$set(this.courseStructure[i].children[n],"fold",!1),this.$set(this.courseStructure[i].children[n].items[o],"isActive",!0),this.currentName=this.courseStructure[i].children[n].items[o].name,this.currentSectionUnitId=this.courseStructure[i].children[n].unit_id,!1},initDefaultShow:function(e){var t=this;this.courseStructure&&this.courseStructure.forEach(function(i){t.$set(i,"fold",!0),t.updateItemStatusByTime(i,e),i.children&&i.children.forEach(function(i){t.$set(i,"fold",!0),t.updateItemStatusByTime(i,e),i.items&&i.items.forEach(function(e){t.$set(e,"isActive",!1)})})}),this.defaultShow(this.elementId,this.chapterId)},updateItemStatusByTime:function(e,t){var i=1e3*e.open_time,n=1e3*e.end_time;e.visible?i&&t<i?(this.$set(e,"show",!1),this.$set(e,"disabled",!1)):n&&t>n?(this.$set(e,"show",!0),this.$set(e,"disabled",!0)):(this.$set(e,"show",!0),this.$set(e,"disabled",!1)):(this.$set(e,"show",!1),this.$set(e,"disabled",!1))}},computed:{},created:function(){this.getData()}}},1261:function(e,t,i){t=e.exports=i(16)(),t.push([e.i,'\n.course-structure-tree__wrap[data-v-5713a656] {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  width: 300px;\n  height: 474px;\n  background: rgba(0, 0, 0, 0.4);\n  z-index: 9999;\n  padding: 10px 15px;\n}\n.course-structure-tree__wrap .course-structure-tree__triangle[data-v-5713a656] {\n    position: absolute;\n    top: -10px;\n    left: 32px;\n    display: inline-block;\n    width: 0px;\n    height: 0px;\n    border-left: 8px solid transparent;\n    border-right: 8px solid transparent;\n    border-bottom: 10px solid rgba(0, 0, 0, 0.4);\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item[data-v-5713a656] {\n    padding: 10px 0;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-chapter-item__name[data-v-5713a656] {\n      display: flex;\n      align-items: center;\n      cursor: pointer;\n      padding: 0 15px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-chapter-item__name .chapter-name[data-v-5713a656] {\n        display: inline-block;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        width: 100%;\n        color: #fff;\n        padding-right: 10px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-chapter-item__name .icon-plus[data-v-5713a656] {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        background: url(//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/appcourseware/add.png) center center no-repeat;\n        background-size: contain;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-chapter-item__name .icon-minus[data-v-5713a656] {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        background: url(//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/appcourseware/minus.png) center center no-repeat;\n        background-size: contain;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap[data-v-5713a656] {\n      margin-bottom: -20px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper[data-v-5713a656] {\n        padding: 8px 0;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item[data-v-5713a656] {\n          padding: 9px 0;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-section-item__name[data-v-5713a656] {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding-left: 30px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-section-item__name .section-name[data-v-5713a656] {\n              display: inline-block;\n              white-space: nowrap;\n              overflow: hidden;\n              text-overflow: ellipsis;\n              width: 100%;\n              color: #fff;\n              padding: 0 10px 0 8px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-section-item__name .el-icon-arrow-up[data-v-5713a656], .course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-section-item__name .el-icon-arrow-down[data-v-5713a656] {\n              color: #FFF;\n              font-weight: 700;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap[data-v-5713a656] {\n            padding-top: 4px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name[data-v-5713a656] {\n              padding: 8px 0 8px 60px;\n              color: #FFF;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-wrap[data-v-5713a656] {\n                display: -webkit-box;\n                display: -moz-box;\n                display: -ms-flexbox;\n                display: flex;\n                align-items: center;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-wrap span[data-v-5713a656] {\n                  cursor: pointer;\n                  width: 170px;\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-wrap .video-seen[data-v-5713a656] {\n                  position: absolute;\n                  top: 5px;\n                  left: 6px;\n                  width: 8px;\n                  height: 8px;\n                  background: url("//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/appcourseware/seen.png") no-repeat;\n                  background-size: 8px 8px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-wrap .video-see[data-v-5713a656] {\n                  position: absolute;\n                  top: 5px;\n                  left: 6px;\n                  width: 8px;\n                  height: 8px;\n                  background: url("//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/appcourseware/see.png") no-repeat;\n                  background-size: 8px 8px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-wrap .graphic-see[data-v-5713a656] {\n                  width: 15px;\n                  height: 15px;\n                  background: url("//storage.xuetangx.com/public_assets/xuetangx/newplat/courseware/graphic.png") no-repeat;\n                  background-size: 15px 15px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-wrap .graphic-seen[data-v-5713a656] {\n                  width: 15px;\n                  height: 15px;\n                  background: url("//storage.xuetangx.com/public_assets/xuetangx/newplat/courseware/graphic-seen.png") no-repeat;\n                  background-size: 15px 15px;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-disabled-wrap[data-v-5713a656] {\n                display: -webkit-box;\n                display: -moz-box;\n                display: -ms-flexbox;\n                display: flex;\n                align-items: center;\n                position: relative;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .section-video-name .element-disabled-wrap span[data-v-5713a656] {\n                  color: #A4ACB4;\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n}\n.course-structure-tree__wrap .course-structure-tree__wrapper .tree-chapter-item .tree-section-item__wrap .tree-section-item__wrapper .tree-section-item .tree-video-item__wrap .video-active[data-v-5713a656] {\n              color: #33A7FF;\n              background: rgba(0, 0, 0, 0.4);\n}\n',""])},1494:function(e,t,i){i(1519);var n=i(19)(i(1247),i(1507),"data-v-5713a656",null);n.options.__file="/Users/xuetangx-lxl/www/plat-frontend/appcourseware/components/lms/catalogue.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] catalogue.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},1507:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"course-structure-tree__wrap"},[i("span",{staticClass:"course-structure-tree__triangle"}),e._v(" "),i("div",{staticStyle:{width:"270px",height:"100%",overflow:"scroll","padding-right":"10px"}},[i("ul",{staticClass:"course-structure-tree__wrapper"},e._l(e.courseStructure,function(t,n){return 0==t.unit_type&&t.show||2==t.unit_type?i("li",{key:n,staticClass:"tree-chapter-item"},[0==t.unit_type?i("div",[i("div",{staticClass:"tree-chapter-item__name",on:{click:function(i){e.changeChapterShow(t)}}},[i("span",{staticClass:"chapter-name"},[e._v(e._s(t.unit_name))]),e._v(" "),i("i",{class:[t.fold?"icon-plus":"icon-minus"]})]),e._v(" "),t.fold?e._e():i("div",{staticClass:"tree-section-item__wrap"},[i("ul",{staticClass:"tree-section-item__wrapper"},e._l(t.children,function(n,o){return 0==n.unit_type&&n.show||1==n.unit_type?i("li",{key:o+"section",staticClass:"tree-section-item"},[0==n.unit_type?i("div",[i("div",{staticClass:"tree-section-item__name",on:{click:function(t){e.changeSectionShow(n)}}},[i("i",{class:[n.fold?"el-icon-arrow-down":"el-icon-arrow-up"]}),e._v(" "),i("span",{staticClass:"section-name"},[e._v(e._s(n.unit_name))])]),e._v(" "),n.fold?e._e():i("ul",{staticClass:"tree-video-item__wrap"},e._l(n.items,function(o,s){return i("li",{key:s+"video",staticClass:"section-video-name",class:[o.isActive?"video-active":""]},[0==o.type?i("div",[n.disabled?i("div",{staticClass:"element-disabled-wrap"},[0==n.unit_type?i("i",{staticClass:"icon-element icon-video"}):e._e(),e._v(" "),i("span",[e._v(" "+e._s(o.name))])]):i("div",{staticClass:"element-wrap",on:{click:function(i){e.changeVideo(o.item_id,t.unit_id,n.unit_type)}}},[i("div",{staticStyle:{position:"relative"}},[i("el-progress",{attrs:{type:"circle",width:18,"stroke-width":2,"show-text":!1,percentage:100*o.rate>=90?100:100*o.rate}}),e._v(" "),o.last_point?i("span",{staticClass:"video-seen"}):i("span",{staticClass:"video-see"})],1),e._v(" "),i("span",[e._v(" "+e._s(o.name))])])]):4==o.type?i("div",{staticStyle:{"margin-left":"2px"}},[n.disabled?i("div",{staticClass:"element-disabled-wrap"},[0==n.unit_type?i("i",{staticClass:"icon-element icon-graphic"}):e._e(),e._v(" "),i("span",[e._v(" "+e._s(o.name))])]):i("div",{staticClass:"element-wrap",on:{click:function(i){e.changeGraphic(o.item_id,t.unit_id,o.type)}}},[o.isReaded?i("span",{staticClass:"graphic-seen"}):i("span",{staticClass:"graphic-see"}),e._v(" "),i("span",[e._v(" "+e._s(o.name))])])]):e._e()])}))]):1==n.unit_type?i("div",[i("div",{staticClass:"tree-section-item__name",on:{click:function(t){e.changeHomework(n.item_id)}}},[i("span",{staticClass:"section-name"},[e._v(e._s(n.name))])])]):e._e()]):e._e()}))])]):2==t.unit_type?i("div",[i("div",{staticClass:"tree-chapter-item__name",on:{click:function(i){e.changeExam(t.item_id)}}},[i("span",{staticClass:"chapter-name"},[e._v(e._s(t.name))])])]):e._e()]):e._e()}))])])},staticRenderFns:[]},e.exports.render._withStripped=!0},1519:function(e,t,i){var n=i(1261);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(20)("24913da2",n,!1)},1659:function(e,t,i){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=i(27),s=n(o);i(521);var a=i(419),r=n(a),d=i(1494),c=n(d);t.default={data:function(){return{videoLastPoint:"",videoRate:0,versionId:"",courseId:"",classId:"",videoId:"",chapterId:"",homeworkId:"",videoUrl:"",isDrag:!0,sources:{},isCaption:!1,captionSrc:[],rate:0,video_params:{imageUrl:"",timeStamp:""},options:[],uploadName:"",selectedIndex:null,courseStructure:null,showStructure:!1,currentName:"",currentUnitType:0,currentSectionUnitId:""}},components:{courseNameTop:r.default,catalogue:c.default},methods:{getVideoLastPoint:function(){var t=this;e.$http.ajax({url:"/video_point/get_video_watched_record?cid="+this.courseId+"&vtype=rate",method:"get",async:!1,success:function(e){if(0==e.code){var i=e.return_data;i[t.videoId]?(t.videoLastPoint=i[t.videoId].last_point,t.videoRate=+i[t.videoId].rate>=.95?1:+i[t.videoId].rate):(t.videoLastPoint=0,t.videoRate=0)}},error:function(e){}})},handleVideoHandoutsList:function(e){this.selectedIndex=e},handleCommand:function(e){this.uploadName=e.upload_name,this.$router.push({path:"handouts",query:{uploadName:this.uploadName}})},getData:function(){this.getVideoLastPoint(),0==this.currentUnitType&&this.getVideoInfo()},selectOptions:function(e,t){var i=this,n="/lms/api/v1/courseware/unit_handout/";n+="?course_id="+this.courseId,n+="&unit_id="+t,n+="&parent_id="+e,this.$http.get(n).then(function(e){if(0===e.data.code)if(i.options=e.data.data.results,i.$route.query.uploadName){i.uploadName=i.$route.query.uploadName;for(var t=0;t<i.options.length;t++)i.uploadName==i.options[t].upload_name&&(i.selectedIndex=t)}else i.options.length>0&&(i.uploadName=i.options[0].upload_name,i.selectedIndex=0)},function(e){})},qarobot:function(t){var i=t&&"object"==(void 0===t?"undefined":(0,s.default)(t))&&"user_id"in t?t.user_id:"",n=t&&"object"==(void 0===t?"undefined":(0,s.default)(t))&&"avatar_url"in t?t.avatar_url:"",o=t&&"object"==(void 0===t?"undefined":(0,s.default)(t))&&"real_name"in t?t.real_name:"";e('<div id="qarobot" cid="'+this.courseId+'" uid="'+i+'" avatar="'+n+'" rn="'+o+'"></div>').appendTo("body"),function(){var e=document.createElement("script");e.src="//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/qa-robot.8df2b8d027a194377602.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()},getVideoInfo:function(){var t=this;e("#video-box").html("");var i="/server/api/class_videos/?video_id="+this.videoId+"&class_id="+this.classId;this.$http.get(i).then(function(i){if(i.data){t.sources=i.data.video_playurl,t.isDrag=!("video_drag"in i.data)||i.data.video_drag,t.videoRate>=1&&(t.isDrag=!0),t.videoUrl=t.sources.quality20[0]||t.sources.quality10[0];var n=i.data.subtitles;t.isCaption=!1,t.captionSrc=[],n&&n.length>0&&(t.isCaption=!0,n.forEach(function(e){if(!e.is_delete){var n={name:e.language,src:"/server/api/fetchOSSCaption/"+e.upload_name,availableSrc:""};i.data.default_subtitle==e.language&&(n.default=!0),t.captionSrc.push(n)}})),e("#video-box").html('<video id="video" preload="true" src="'+t.videoUrl+'" ><p>您的浏览器不支持HTML5播放器！</p></video>');var o=t,a=t.$store.state.userinfo.userInfo?t.$store.state.userinfo.userInfo:t.userInfo,r=a&&"object"==(void 0===a?"undefined":(0,s.default)(a))&&"user_id"in a?a.user_id:"";t.qarobot(a),e("#video").xtVideo({id:o.videoId,cid:o.courseId,cc:o.videoId,userId:r,autoplay:!0,heartSrc:"/heartbeat",isDrag:o.isDrag,isHeart:!0,log:!0,volume:{value:.8},speed:{show:!0,value:1,speedValue:[2.5,2,1.5,1,.5]},isShowControls:!0,isShowProgress:!0,hiddenQuestion:!0,hiddenKnowledgePoint:!0,quality:{show:!1},caption:{show:o.isCaption,src:o.captionSrc},startTime:o.videoLastPoint?parseFloat(o.videoLastPoint):0,endTime:0,position:0}).on("canplay",function(){}).on("timeupdate",function(){})}})},printScreen:function(){var t=e("#video").get(0);return void t.pause();var t},uploadScreenshot:function(e){var t=this;/^data:image\/\w+;base64,/.test(e)&&this.$http.post("/server/api/upload_video_img_to_oss",{base64:e}).then(function(e){0==e.data.code?t.video_params.imageUrl=e.data.path:t.$message.error(e.data.message)}).catch(function(e){t.$message.error(e.data.message)})},$:function(e){return document.getElementsByClassName(e)},drag:function(t){var i=this.$("section-left")[0],n=(this.$("section-right")[0],this.$("section-middle-drag")[0]),o=this.$("video-container")[0],s=(t||window.event).clientX,a=n.offsetLeft;return o.onmousemove=function(t){var n=a+((t||window.event).clientX-s),o=document.body.clientWidth;return n<0&&(n=0),n>o&&(n=o),i.style.width=n+"px",e(window).trigger("resize.player"),!1},n.setCapture&&n.setCapture(),!1},release:function(){var e=this.$("section-middle-drag")[0],t=this.$("video-container")[0];t.onmousemove=null,t.onmouseup=null,e.releaseCapture&&e.releaseCapture()},getCurrentName:function(e){this.currentName=e},getSectionUnitId:function(e){this.currentSectionUnitId=e}},watch:{"$route.params.video_id":function(e,t){window.location.reload()},"$route.params.chapter_id":function(e,t){window.location.reload()},currentSectionUnitId:function(e){this.selectOptions(this.chapterId,e)}},computed:{userInfo:function(){return this.$store.state.userinfo.userInfo}},created:function(){this.courseId=this.$route.params.id,this.classId=this.$route.params.class_id,this.videoId=this.$route.params.video_id,this.chapterId=this.$route.params.chapter_id,this.currentUnitType=this.$route.params.unit_type,this.getData();var t=this;this.$nextTick(function(){e("body").off("click").on("click",function(i){var n=e(i.target),o=i.clientX,s=i.clientY;if(e(".video-main").length>0&&e(".course-structure-tree__wrap").length>0){var a=e(".video-main").find(".course-structure-tree__wrap")[0].getBoundingClientRect();if(!(o>=a.left&&o<=a.right&&s>=a.top&&s<=a.bottom)){if(n.hasClass("select-chapter"))return!1;t.showStructure=!1}}})})},mounted:function(){}}}).call(t,i(47))},1740:function(e,t,i){t=e.exports=i(16)(),t.push([e.i,'\n.video .video-container[data-v-2932c7e8] {\n  position: relative;\n  width: 100%;\n  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);\n  margin: 20px 8px 70px;\n}\n.video .video-container .section-left[data-v-2932c7e8] {\n    width: 70%;\n    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);\n}\n.video .video-container .section-left .video-header[data-v-2932c7e8] {\n      height: 70px;\n      font-size: 16px;\n      color: #333333;\n      margin-left: 32px;\n      display: -webkit-box;\n      display: -webkit-flex;\n      display: -moz-box;\n      display: -ms-flexbox;\n      display: flex;\n      align-items: center;\n}\n.video .video-container .section-left .video-header .select-chapter[data-v-2932c7e8] {\n        cursor: pointer;\n        font-size: 14px;\n        color: #767c80;\n        display: inline-block;\n        height: 14px;\n        background: url(//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/appcourseware/three-line.png) left center no-repeat;\n        background-size: contain;\n        padding-left: 26px;\n}\n.video .video-container .section-left .video-header .select-chapter[data-v-2932c7e8]:hover {\n          color: #33A7FF;\n          background: url(//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/appcourseware/three-line-blue.png) left center no-repeat;\n          background-size: contain;\n}\n.video .video-container .section-left .video-header .chapter-name[data-v-2932c7e8] {\n        flex: 1;\n        text-align: center;\n}\n.video .video-container .section-left .video-main[data-v-2932c7e8] {\n      position: relative;\n      width: 100%;\n      height: 514px;\n      background: #000;\n}\n.video .video-container .section-left .video-main .video-box[data-v-2932c7e8] {\n        position: relative;\n        width: 100%;\n        background: #000;\n        padding: 0;\n        margin: 0;\n        height: 100%;\n        overflow: hidden;\n}\n.video .video-container .section-middle-drag[data-v-2932c7e8] {\n    width: 5px;\n    height: 100%;\n}\n.video .video-container .section-middle-drag .section-middle-drag-inner[data-v-2932c7e8] {\n      position: absolute;\n      top: 70px;\n      width: 5px;\n      height: 514px;\n      background: #ccc;\n      cursor: col-resize;\n}\n.video .video-container .section-right[data-v-2932c7e8] {\n    overflow: hidden;\n    zoom: 1;\n}\n.video .video-container .section-right .nav[data-v-2932c7e8] {\n      margin-top: 20px;\n      box-sizing: border-box;\n      padding: 0 10px;\n      font-size: 14px;\n      color: #333;\n}\n.video .video-container .section-right .nav li[data-v-2932c7e8] {\n        display: inline-block;\n        height: 50px;\n        line-height: 50px;\n        padding: 0 20px;\n        margin: 0 15px;\n        cursor: pointer;\n}\n.video .video-container .section-right .nav .active[data-v-2932c7e8] {\n        color: #33A7FF;\n        border-bottom: 3px solid #33A7FF;\n}\n.video .video-container .section-right .nav .active .el-button[data-v-2932c7e8] {\n          color: #2095F3;\n}\n.video .video-container .section-right .nav .active .el-button[data-v-2932c7e8]:hover {\n          color: #2095F3;\n          background-color: #fff;\n}\n.el-dropdown-menu .videoHandoutsListSelected[data-v-2932c7e8] {\n  background: #e5eff5;\n}\n.el-dropdown-menu .videoHandoutsList[data-v-2932c7e8] {\n  text-align: center;\n  width: 250px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  color: #333;\n}\n.el-dropdown-menu .videoHandoutsList[data-v-2932c7e8]:hover {\n    color: #333;\n    background: #F1F4F6;\n}\n.icon-element[data-v-2932c7e8] {\n  width: 18px;\n  height: 18px;\n  display: inline-block;\n  margin-right: 5px;\n}\n.icon-video[data-v-2932c7e8] {\n  background: url("//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/video.png") no-repeat center;\n  background-size: 18px 18px;\n}\n.icon-video-active[data-v-2932c7e8] {\n  background: url("//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/video_active.png") no-repeat center;\n  background-size: 18px 18px;\n}\n',""])},1930:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"video"},[i("course-name-top",{attrs:{courseId:e.courseId,classId:e.classId,from:0}}),e._v(" "),i("el-row",{attrs:{type:"flex",justify:"center"}},[i("div",{staticClass:"video-container"},[i("section",{staticClass:"section-left fl clearfix",attrs:{id:"video-wrap"}},[i("div",{staticClass:"video-header"},[i("span",{staticClass:"select-chapter",on:{click:function(t){e.showStructure=!e.showStructure}}},[e._v("选择章节")]),e._v(" "),i("span",{staticClass:"chapter-name"},[e._v(e._s(e.currentName))])]),e._v(" "),i("div",{staticClass:"video-main"},[i("div",{staticClass:"video-box",attrs:{id:"video-box"}}),e._v(" "),i("catalogue",{directives:[{name:"show",rawName:"v-show",value:e.showStructure,expression:"showStructure"}],attrs:{courseId:e.courseId,classId:e.classId,chapterId:e.chapterId,elementId:e.videoId,unitType:e.currentUnitType},on:{nameChange:e.getCurrentName,sectionChange:e.getSectionUnitId}})],1),e._v(" "),i("div",{staticClass:"video-footer"})]),e._v(" "),i("section",{staticClass:"section-middle-drag fl",on:{mousedown:function(t){e.drag(t)},mouseup:e.release}},[i("div",{staticClass:"section-middle-drag-inner"})]),e._v(" "),i("section",{staticClass:"section-right"},[i("ul",{staticClass:"nav"},[i("router-link",{attrs:{tag:"li",to:{name:"videoDiscussion"},"active-class":"active"}},[e._v("讨论区")]),e._v(" "),e.options.length>0?i("router-link",{staticClass:"video-nav-handout",attrs:{tag:"li",to:{name:"handouts",query:{uploadName:e.uploadName}},"active-class":"active"}},[i("el-dropdown",{attrs:{"split-button":!0,trigger:"click"},on:{command:e.handleCommand}},[e._v("\n                            讲义\n                            "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.options,function(t,n){return i("el-dropdown-item",{key:n,class:[{videoHandoutsListSelected:e.selectedIndex==n},{videoHandoutsList:!0}],attrs:{command:t},nativeOn:{click:function(t){e.handleVideoHandoutsList(n)}}},[e._v("\n                                    "+e._s(t.name+"."+t.format)+"\n                                ")])}))],1)],1):i("router-link",{attrs:{tag:"li",to:{name:"handouts"},"active-class":"active"}},[e._v("讲义")])],1),e._v(" "),i("div",{staticClass:"other"},[i("router-view",{attrs:{videoParams:e.video_params},on:{printScreen:e.printScreen}})],1)])])])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},2096:function(e,t,i){var n=i(1740);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(20)("09fd5806",n,!1)},519:function(e,t,i){i(2096);var n=i(19)(i(1659),i(1930),"data-v-2932c7e8",null);n.options.__file="/Users/xuetangx-lxl/www/plat-frontend/appcourseware/components/lms/video.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] video.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},521:function(e,t,i){(function(e){!function(t){var i=function(e,i){this.defaultOptions={},this.options=t.extend({id:"",cid:"",cc:"",userId:"",log:!0,isDrag:!0,isAbleOcclusion:!1,isHeart:!0,heartSrc:null,saveStateUrl:"",autoplay:!1,hiddenQuestion:!1,hiddenKnowledgePoint:!1,duration:0,volume:{value:.8},speed:{show:!0,value:1,speedValue:[2.5,2,1.5,1,.5]},multiplySyncVideo:{src:"",mainPoint:[]},isShowControls:!0,isShowProgress:!0,caption:{},quality:{},download:{},quiz:null,position:null,startTime:null,endTime:null},this.defaultOptions,i||{}),this.util.loadStyle("//storagecdn.xuetangx.com/public_assets/xuetangx/newplat/b1e31f5eab3f5e7ff6e1a19397e16fbe.xtVideo.min.css"),this.options.ccid&&(this.options.cc=this.options.ccid),this.video=e.get(0),this.$video=e,this.$wrap=null,this.$container=null,this.$controls=null,this.$parent=e.parent(),this.asideCaptionWidth=this.options.asideCaptionWidth,this.language=(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage).toLowerCase(),this.i18n={"中文":"zh-cn"==this.language?"中文":"Chinese","英文":"zh-cn"==this.language?"英文":"English","普清":"zh-cn"==this.language?"普清":"ND","标清":"zh-cn"==this.language?"标清":"ND","高清":"zh-cn"==this.language?"高清":"HD","字幕":"zh-cn"==this.language?"字幕":"caption","右侧":"zh-cn"==this.language?"右侧":"aside","下方":"zh-cn"==this.language?"下方":"down","知识要点":"zh-cn"==this.language?"知识要点":"Main Points","跳过":"zh-cn"==this.language?"跳过":"Skip","提交":"zh-cn"==this.language?"提交":"Submit","正在提交...":"zh-cn"==this.language?"正在提交...":"Submitting…","继续播放":"zh-cn"==this.language?"继续播放":"Resume Play","回答正确！学霸君，棒棒哒！":"zh-cn"==this.language?"回答正确！学霸君，棒棒哒！":"Correct！Zha Great！","回答错误，别气馁，再试一次！":"zh-cn"==this.language?"回答错误，别气馁，再试一次！":"Wrong answer, Hang in there, try again!","重复提交":"zh-cn"==this.language?"重复提交":"Resubmit","提交失败，再试一次！":"zh-cn"==this.language?"提交失败，再试一次！":"Fail to submit, try again!"},this.init()};i.prototype.init=function(){this.$video=this.$video.wrap('<div class="xt_video_player_container"><div class="xt_video_player_wrap"></div></div>').addClass("xt_video_player"),this.$wrap=this.$video.parent().css({width:this.options.multiplySyncVideo.src?"70%":"100%"}),this.$video.on("loadedmetadata.init",function(){this.options.duration=this.video.duration,t("#qarobot").length>0&&this.knowledge_navigation()}.bind(this)),this.$container=this.$wrap.parent().css({}),this.$video.removeAttr("controls"),this.options.isShowControls?this.$controls=t('<div class="xt_video_player_controls cf"></div>').appendTo(this.$wrap):this.$controls=t('<div class="xt_video_player_controls cf" style="display: none;opacity: 0;"></div>').appendTo(this.$wrap),this.$wrap.on({mouseover:function(){this.$video.trigger("video.mouseover")}.bind(this),mouseout:function(){this.$video.trigger("video.mouseout")}.bind(this)}),this.$wrap.on("mousemove",function(){var e=null;return function(){this.$controls.addClass("xt_video_player_controls_show"),clearTimeout(e),e=setTimeout(function(){if(this.video.paused)return!1;this.$controls.removeClass("xt_video_player_controls_show")}.bind(this),3e3)}.bind(this)}.bind(this)()),this.options.multiplySyncVideo.src&&t('<div class="xt_video_player_multiply_sync_video xt_video_player_caption_aside" style="width: 30%;"><video muted preload="auto" src="'+this.options.multiplySyncVideo.src+'"></video></div>').appendTo(this.$container);for(var e in i.prototype)i.prototype.hasOwnProperty(e)&&"init"!==e&&"floadObj"!==e&&"question"!==e&&"knowledge_navigation"!==e&&"heartlog"!==e&&this[e]instanceof Function&&this[e]();t("#qarobot").length>0&&this.question(),this.heartlog()},i.prototype.util={loadScript:function(e,t){var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,t())}:i.onload=function(){t()},i.src=e,document.getElementsByTagName("head")[0].appendChild(i)},loadStyle:function(e){t('<link rel="stylesheet" href="'+e+'"></link>').appendTo(t("head"))},fullScreenApi:function(){!function(t,i){i(e)}(0,function(e){function t(e){return void 0!==e}function i(t,i,n){var o=function(){};o.prototype=i.prototype,t.prototype=new o,t.prototype.constructor=t,i.prototype.constructor=i,t._super=i.prototype,n&&e.extend(t.prototype,n)}function n(e,i){var n;"string"==typeof e&&(i=e,e=document);for(var a=0;a<o.length;++a){i=i.replace(o[a][0],o[a][1]);for(var r=0;r<s.length;++r)if(n=s[r],n+=0===r?i:i.charAt(0).toUpperCase()+i.substr(1),t(e[n]))return e[n]}}var o=[["",""],["exit","cancel"],["screen","Screen"]],s=["","o","ms","moz","webkit","webkitCurrent"],a=navigator.userAgent,r=n("fullscreenEnabled"),d=a.match(/Android.*Chrome\/(\d+)\./),c=!!d;c&&(ANDROID_CHROME_VERSION=parseInt(d[1]));var l=(!c||ANDROID_CHROME_VERSION>37)&&t(n("fullscreenElement"))&&(!t(r)||!0===r),u=e.fn.jquery.split("."),p=parseInt(u[0])<2&&parseInt(u[1])<7,h=function(){this.__options=null,this._fullScreenElement=null,this.__savedStyles={}};h.prototype={native:n,_DEFAULT_OPTIONS:{styles:{boxSizing:"border-box",MozBoxSizing:"border-box",WebkitBoxSizing:"border-box"},toggleClass:null},__documentOverflow:"",__htmlOverflow:"",_preventDocumentScroll:function(){this.__documentOverflow=document.body.style.overflow,this.__htmlOverflow=document.documentElement.style.overflow,e(this._fullScreenElement).is("body, html")||e("body, html").css("overflow","hidden")},_allowDocumentScroll:function(){document.body.style.overflow=this.__documentOverflow,document.documentElement.style.overflow=this.__htmlOverflow},_fullScreenChange:function(){this.__options&&(this.isFullScreen()?(this._preventDocumentScroll(),this._triggerEvents()):(this._allowDocumentScroll(),this._revertStyles(),this._triggerEvents(),this._fullScreenElement=null))},_fullScreenError:function(t){this.__options&&(this._revertStyles(),this._fullScreenElement=null,t&&e(document).trigger("fscreenerror",[t]))},_triggerEvents:function(){e(this._fullScreenElement).trigger(this.isFullScreen()?"fscreenopen":"fscreenclose"),e(document).trigger("fscreenchange",[this.isFullScreen(),this._fullScreenElement])},_saveAndApplyStyles:function(){var t=e(this._fullScreenElement);this.__savedStyles={};for(var i in this.__options.styles)this.__savedStyles[i]=this._fullScreenElement.style[i],this._fullScreenElement.style[i]=this.__options.styles[i];t.is("body")&&(document.documentElement.style.overflow=this.__options.styles.overflow),this.__options.toggleClass&&t.addClass(this.__options.toggleClass)},_revertStyles:function(){var t=e(this._fullScreenElement);for(var i in this.__options.styles)this._fullScreenElement.style[i]=this.__savedStyles[i];t.is("body")&&(document.documentElement.style.overflow=this.__savedStyles.overflow),this.__options.toggleClass&&t.removeClass(this.__options.toggleClass)},open:function(t,i){t!==this._fullScreenElement&&(this.isFullScreen()&&this.exit(),this._fullScreenElement=t,this.__options=e.extend(!0,{},this._DEFAULT_OPTIONS,i),this._saveAndApplyStyles())},exit:null,isFullScreen:null,isNativelySupported:function(){return l}};var v=function(){v._super.constructor.apply(this,arguments),this.exit=e.proxy(n("exitFullscreen"),document),this._DEFAULT_OPTIONS=e.extend(!0,{},this._DEFAULT_OPTIONS,{styles:{width:"100%",height:"100%"}}),e(document).bind(this._prefixedString("fullscreenchange")+" MSFullscreenChange",e.proxy(this._fullScreenChange,this)).bind(this._prefixedString("fullscreenerror")+" MSFullscreenError",e.proxy(this._fullScreenError,this))};i(v,h,{VENDOR_PREFIXES:["","o","moz","webkit"],_prefixedString:function(t){return e.map(this.VENDOR_PREFIXES,function(e){return e+t}).join(" ")},open:function(e,t){v._super.open.apply(this,arguments),n(e,"requestFullscreen").call(e)},exit:e.noop,isFullScreen:function(){return null!==n("fullscreenElement")},element:function(){return n("fullscreenElement")}});var _=function(){_._super.constructor.apply(this,arguments),this._DEFAULT_OPTIONS=e.extend({},this._DEFAULT_OPTIONS,{styles:{position:"fixed",zIndex:"2147483647",left:0,top:0,bottom:0,right:0}}),this.__delegateKeydownHandler()};return i(_,h,{__isFullScreen:!1,__delegateKeydownHandler:function(){var t=e(document);t.delegate("*","keydown.fullscreen",e.proxy(this.__keydownHandler,this));var i=p?t.data("events"):e._data(document).events,n=i.keydown;p?i.live.unshift(i.live.pop()):n.splice(0,0,n.splice(n.delegateCount-1,1)[0])},__keydownHandler:function(e){return!this.isFullScreen()||27!==e.which||(this.exit(),!1)},_revertStyles:function(){_._super._revertStyles.apply(this,arguments),this._fullScreenElement.offsetHeight},open:function(e){_._super.open.apply(this,arguments),this.__isFullScreen=!0,this._fullScreenChange()},exit:function(){this.__isFullScreen&&(this.__isFullScreen=!1,this._fullScreenChange())},isFullScreen:function(){return this.__isFullScreen},element:function(){return this.__isFullScreen?this._fullScreenElement:null}}),e.fullscreen=l?new v:new _,e.fn.fullscreen=function(t){var i=this[0];return t=e.extend({toggleClass:null,overflow:"hidden"},t),t.styles={overflow:t.overflow},delete t.overflow,i&&(e.fullscreen.open(i,t),"function"==typeof t.xmcalback&&t.xmcalback()),this},e.fullscreen})},saveState:function(e,i){if(!this.options.saveStateUrl)return!1;i=!i,t.isPlainObject(e)||(e={saved_video_position:this.video.currentTime}),e.hasOwnProperty("saved_video_position")&&(e.saved_video_position=this.util.timeFull(this.video.currentTime)),this.util._ajax({url:this.options.saveStateUrl,type:"POST",dataType:"json",async:i,data:e})},timeFull:function(e){var t,i,n,o=function(e){return e<10?"0"+e:""+e};return e<0&&(e=0),n=Math.floor(e),i=Math.floor(n/60),t=Math.floor(i/60),n%=60,i%=60,o(t)+":"+o(i)+":"+o(n%60)},md5:function(){!function(e){"use strict";function t(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function i(e,t){return e<<t|e>>>32-t}function n(e,n,o,s,a,r){return t(i(t(t(n,e),t(s,r)),a),o)}function o(e,t,i,o,s,a,r){return n(t&i|~t&o,e,t,s,a,r)}function s(e,t,i,o,s,a,r){return n(t&o|i&~o,e,t,s,a,r)}function a(e,t,i,o,s,a,r){return n(t^i^o,e,t,s,a,r)}function r(e,t,i,o,s,a,r){return n(i^(t|~o),e,t,s,a,r)}function d(e,i){e[i>>5]|=128<<i%32,e[14+(i+64>>>9<<4)]=i;var n,d,c,l,u,p=1732584193,h=-271733879,v=-1732584194,_=271733878;for(n=0;n<e.length;n+=16)d=p,c=h,l=v,u=_,p=o(p,h,v,_,e[n],7,-680876936),_=o(_,p,h,v,e[n+1],12,-389564586),v=o(v,_,p,h,e[n+2],17,606105819),h=o(h,v,_,p,e[n+3],22,-1044525330),p=o(p,h,v,_,e[n+4],7,-176418897),_=o(_,p,h,v,e[n+5],12,1200080426),v=o(v,_,p,h,e[n+6],17,-1473231341),h=o(h,v,_,p,e[n+7],22,-45705983),p=o(p,h,v,_,e[n+8],7,1770035416),_=o(_,p,h,v,e[n+9],12,-1958414417),v=o(v,_,p,h,e[n+10],17,-42063),h=o(h,v,_,p,e[n+11],22,-1990404162),p=o(p,h,v,_,e[n+12],7,1804603682),_=o(_,p,h,v,e[n+13],12,-40341101),v=o(v,_,p,h,e[n+14],17,-1502002290),h=o(h,v,_,p,e[n+15],22,1236535329),p=s(p,h,v,_,e[n+1],5,-165796510),_=s(_,p,h,v,e[n+6],9,-1069501632),v=s(v,_,p,h,e[n+11],14,643717713),h=s(h,v,_,p,e[n],20,-373897302),p=s(p,h,v,_,e[n+5],5,-701558691),_=s(_,p,h,v,e[n+10],9,38016083),v=s(v,_,p,h,e[n+15],14,-660478335),h=s(h,v,_,p,e[n+4],20,-405537848),p=s(p,h,v,_,e[n+9],5,568446438),_=s(_,p,h,v,e[n+14],9,-1019803690),v=s(v,_,p,h,e[n+3],14,-187363961),h=s(h,v,_,p,e[n+8],20,1163531501),p=s(p,h,v,_,e[n+13],5,-1444681467),_=s(_,p,h,v,e[n+2],9,-51403784),v=s(v,_,p,h,e[n+7],14,1735328473),h=s(h,v,_,p,e[n+12],20,-1926607734),p=a(p,h,v,_,e[n+5],4,-378558),_=a(_,p,h,v,e[n+8],11,-2022574463),v=a(v,_,p,h,e[n+11],16,1839030562),h=a(h,v,_,p,e[n+14],23,-35309556),p=a(p,h,v,_,e[n+1],4,-1530992060),_=a(_,p,h,v,e[n+4],11,1272893353),v=a(v,_,p,h,e[n+7],16,-155497632),h=a(h,v,_,p,e[n+10],23,-1094730640),p=a(p,h,v,_,e[n+13],4,681279174),_=a(_,p,h,v,e[n],11,-358537222),v=a(v,_,p,h,e[n+3],16,-722521979),h=a(h,v,_,p,e[n+6],23,76029189),p=a(p,h,v,_,e[n+9],4,-640364487),_=a(_,p,h,v,e[n+12],11,-421815835),v=a(v,_,p,h,e[n+15],16,530742520),h=a(h,v,_,p,e[n+2],23,-995338651),p=r(p,h,v,_,e[n],6,-198630844),_=r(_,p,h,v,e[n+7],10,1126891415),v=r(v,_,p,h,e[n+14],15,-1416354905),h=r(h,v,_,p,e[n+5],21,-57434055),p=r(p,h,v,_,e[n+12],6,1700485571),_=r(_,p,h,v,e[n+3],10,-1894986606),v=r(v,_,p,h,e[n+10],15,-1051523),h=r(h,v,_,p,e[n+1],21,-2054922799),p=r(p,h,v,_,e[n+8],6,1873313359),_=r(_,p,h,v,e[n+15],10,-30611744),v=r(v,_,p,h,e[n+6],15,-1560198380),h=r(h,v,_,p,e[n+13],21,1309151649),p=r(p,h,v,_,e[n+4],6,-145523070),_=r(_,p,h,v,e[n+11],10,-1120210379),v=r(v,_,p,h,e[n+2],15,718787259),h=r(h,v,_,p,e[n+9],21,-343485551),p=t(p,d),h=t(h,c),v=t(v,l),_=t(_,u);return[p,h,v,_]}function c(e){var t,i="";for(t=0;t<32*e.length;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function l(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<8*e.length;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function u(e){return c(d(l(e),8*e.length))}function p(e,t){var i,n,o=l(e),s=[],a=[];for(s[15]=a[15]=void 0,o.length>16&&(o=d(o,8*e.length)),i=0;i<16;i+=1)s[i]=909522486^o[i],a[i]=1549556828^o[i];return n=d(s.concat(l(t)),512+8*t.length),c(d(a.concat(n),640))}function h(e){var t,i,n="0123456789abcdef",o="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),o+=n.charAt(t>>>4&15)+n.charAt(15&t);return o}function v(e){return unescape(encodeURIComponent(e))}function _(e){return u(v(e))}function m(e){return h(_(e))}function f(e,t){return p(v(e),v(t))}function g(e,t){return h(f(e,t))}function x(e,t,i){return t?i?f(t,e):g(t,e):i?_(e):m(e)}e.md5=x}(t)},timeFormat:function(e){var t=e.split(":");return 60*t[0]*60+60*t[1]+1*t[2]},_ajax:function(e){if("/event"==e.url)return!1;if(void 0===e.async&&(e.async=!0),e.success&&"function"==typeof e.success){var i=e.success;e.success=function(e){return function(t){e({data:t})}}(i)}t.ajax(e)}},i.prototype.floadObj=function(){function e(e){return Math.floor(e)===e}function t(t){var i={times:1,num:0},n=t<0;if(e(t))return i.num=t,i;var o=t+"",s=o.indexOf("."),a=o.substr(s+1).length,r=Math.pow(10,a),d=parseInt(Math.abs(t)*r+.5,10);return i.times=r,n&&(d=-d),i.num=d,i}function i(e,i,n,o){var s=t(e),a=t(i),r=s.num,d=a.num,c=s.times,l=a.times,u=c>l?c:l;switch(o){case"add":return(c===l?r+d:c>l?r+d*(c/l):r*(l/c)+d)/u;case"subtract":return(c===l?r-d:c>l?r-d*(c/l):r*(l/c)-d)/u;case"multiply":return r*d/(c*l);case"divide":return r/d*(l/c)}}function n(e,t,n){return i(e,t,n,"add")}function o(e,t,n){return i(e,t,n,"subtract")}function s(e,t,n){return i(e,t,n,"multiply")}function a(e,t,n){return i(e,t,n,"divide")}return{add:n,subtract:o,multiply:s,divide:a}}(),i.prototype.beforeunload=function(){t(window).on("beforeunload",function(){this.video.paused||this.util.saveState.call(this,null,!0)}.bind(this))},i.prototype.continued=function(){this.options.position&&this.$video.on("loadedmetadata.continued",function(){this.video.duration-this.options.position>5&&(this.video.currentTime=this.options.position,this.$video.off("loadedmetadata.continued"))}.bind(this))},i.prototype.playBtn=function(){var e="";e=this.$video.prop("autoplay")?"xt_video_player_play_btn_pause":"";var i=t('<div class="xt_video_player_play_btn fl '+e+'"></div>').on("click",function(e){this.$video.trigger("playBtn.toggle")}.bind(this)).appendTo(this.$controls);this.$video.on("click",function(){this.$video.trigger("playBtn.toggle")}.bind(this)),this.$video.on("ended",function(){i.removeClass("xt_video_player_play_btn_pause")}),this.$video.on("play",function(){i.addClass("xt_video_player_play_btn_pause")}),this.$video.on("pause",function(){this.util.saveState.call(this),i.removeClass("xt_video_player_play_btn_pause")}.bind(this)),this.$video.on("playBtn.toggle",function(e,t){var i=null;t&&"type"in t&&t.type&&(i=t.type),this.video.paused?"pause"!=i&&this.video.play():"play"!=i?this.video.pause():this.$video.trigger("heartbeatPlay")}.bind(this))},i.prototype.winTriggerHidden=function(){function e(e){if(i.options.isAbleOcclusion)return!1;var t="visible",s="hidden",a={focus:t,focusin:t,pageshow:t,blur:s,focusout:s,pagehide:s};e=e||window.event,e.type in a?a[e.type]==s?(o=!0,i.$video.trigger("playBtn.toggle",{type:"pause"})):o&&(o=!1):this[n]?(o=!0,i.$video.trigger("playBtn.toggle",{type:"pause"})):o&&(o=!1)}var i=this,n=(document.title,"hidden"),o=!1;n in document?t(document).on("visibilitychange",e):(n="mozHidden")in document?t(document).on("mozvisibilitychange",e):(n="webkitHidden")in document?t(document).on("webkitvisibilitychange",e):(n="msHidden")in document&&t(document).on("msvisibilitychange",e),"onfocusin"in document&&(document.onfocusin=document.onfocusout=e),window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e,void 0!==document[n]&&e({type:document[n]?"blur":"focus"})},i.prototype.loader=function(){var e=t('<div class="spinner"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div>').appendTo(this.$wrap);this.$video.on("waiting",function(){e.show()}),this.$video.on("canplay playing",function(t){e.hide()}),this.$video.on("loader.isShow",function(t,i){i.isShow=e.is(":visible")})},i.prototype.autoplay=function(){this.$video.prop("autoplay")||this.options.autoplay?this.$video.on("canplay.autoplay",function(){this.$video.trigger("playBtn.toggle",{type:"play"}),this.$video.off("canplay.autoplay")}.bind(this)):this.$controls.addClass("xt_video_player_controls_show")},i.prototype.currentTimeDisplay=function(){var e=t('<div class="xt_video_player_current_time_display fl"><span>0:00</span> / <span>0:00</span></div>').appendTo(this.$controls),i=e.find("span").eq(0),n=e.find("span").eq(1),o=function(e){return e<10&&(e="0"+e.toString()),e};this.$video.on("durationchange",function(){var e=parseInt(this.video.duration/60),t=parseInt(this.video.duration%60);n.html(e+":"+o(t))}.bind(this)),this.$video.on("timeupdate",function(e){var t=parseInt(this.video.currentTime/60),n=parseInt(this.video.currentTime%60);i.html(t+":"+o(n))}.bind(this))},i.prototype.volume=function(){this.options&&this.options&&this.options.volume&&!isNaN(this.options.volume.value)?this.video.volume=this.options.volume.value:this.video.volume=this.options.volume.value||.8;var e=t('<div class="xt_video_player_volume fl cf"> <div class="xt_video_player_volume_icon fl"></div> <div class="xt_video_player_volume_wrap fl"> <div class="xt_video_player_volume_progress"> <div class="xt_video_player_volume_block"> </div> <div class="xt_video_player_volume_seek"></div> </div> </div> </div>').appendTo(this.$controls),i=e.find(".xt_video_player_volume_progress"),n=e.find(".xt_video_player_volume_seek").css({left:100*this.video.volume+"%"}),o=e.find(".xt_video_player_volume_block").css({width:100*this.video.volume+"%"}),s=e.find(".xt_video_player_volume_icon"),a=t(document),r=0,d=parseInt(i.width()),c=null,l=1,u=function(e){var t=e.pageX-r;t<0&&(t=0),t>d&&(t=d),n.css({left:t}),o.css({width:t}),d=parseInt(i.width());var a=t/d;this.video.volume=a,l=a,a<=0?s.addClass("xt_video_player_volume_muted"):s.removeClass("xt_video_player_volume_muted")}.bind(this);n.on("mousedown",function(){c=!0,r=i.offset().left,a.on("mousemove",u)}),a.on("mouseup",function(){c&&(c=!1,a.off("mousemove",u))}),i.on("click",function(e){r=i.offset().left;var t=e.pageX-r;t<0&&(t=0),t>d&&(t=d),o.css({width:t}),n.css({left:t}),d=parseInt(i.width());var a=t/d;this.video.volume=a,l=a,a<=0?s.addClass("xt_video_player_volume_muted"):s.removeClass("xt_video_player_volume_muted")}.bind(this));var p=null,h=e.find(".xt_video_player_volume_wrap");s.on("click",function(e){var i=t(e.target);if(i.hasClass("xt_video_player_volume_muted")){this.video.volume=l;var s=d*l;n.css("left",s),o.css("width",s),i.removeClass("xt_video_player_volume_muted")}else this.video.volume=0,n.css("left",0),o.css("width",0),i.addClass("xt_video_player_volume_muted")}.bind(this)).on({mouseover:function(){clearTimeout(p),h.css("width",100)},mouseout:function(){p=setTimeout(function(){h.css("width",0)},100)}}),h.on("mouseover",function(){clearTimeout(p)}).on("mouseout",function(){p=setTimeout(function(){h.css("width",0)},100)})},i.prototype.fullScreen=function(){t.fullscreen||this.util.fullScreenApi();var e=t('<div class="xt_video_player_fullscreen fr"></div>').on("click",function(e){this.$wrap.hasClass("xt_video_player_full_screen")?(t.fullscreen.exit(),t("#robot_question_wrap").css({marginTop:"10px",fontSize:"14px"}),t("#xm_head").css({width:"44px",height:"50px"}),t("#question_text_wrap").css({height:"30px",margin:"13px 0px 0px 26px"}),t("#question_text").css({margin:"6px 30px 0 11px",paddingRight:"2px"}),t("#praise").css({top:"6px",right:"7px",width:"16px",height:"16px"})):this.$container.fullscreen({xmcalback:function(){t("#robot_question_wrap").css({marginTop:"50px",fontSize:"16px"}),t("#xm_head").css({width:"54px",height:"63px"}),t("#question_text_wrap").css({height:"36px",margin:"15px 0px 0px 26px"}),t("#question_text").css({margin:"8px 30px 0 11px",paddingRight:"2px"}),t("#praise").css({top:"8px",right:"7px",width:"18px",height:"18px"})}})}.bind(this)).appendTo(this.$controls);t(document).on("fscreenchange",function(){t.fullscreen.isFullScreen()?(this.$wrap.add(this.$video).addClass("xt_video_player_full_screen"),e.addClass("xt_video_player_fullscreen_cancel"),this.$video.trigger("captionBtn.asideHide")):(this.$wrap.add(this.$video).removeClass("xt_video_player_full_screen"),e.removeClass("xt_video_player_fullscreen_cancel"),this.$video.trigger("captionBtn.asideShow"))}.bind(this))},i.prototype.speed=function(){if(!this.options||!this.options.speed||!this.options.speed.show)return!1;var e=1;this.options.speed.value&&(e=this.options.speed.value,this.$video.on("loadedmetadata",function(){this.playbackRate=e}));var i="";this.options.speed.speedValue.forEach(function(t){i+=t==e?'<li data-speed="'+t+'" class="xt_video_player_common_active">'+t.toFixed(2)+"x</li>":'<li data-speed="'+t+'">'+t.toFixed(2)+"x</li>"});var n=t('<div class="xt_video_player_speed xt_video_player_common fr"><div class="xt_video_player_common_value">'+e.toFixed(2)+'x</div><ul class="xt_video_player_common_list">'+i+"</ul></div>").appendTo(this.$controls).on({mouseover:function(){o.show()},mouseout:function(){o.hide()}}),o=n.find(".xt_video_player_common_list"),s=n.find(".xt_video_player_common_value"),a=e;n.find("li").on("click",function(e){var i=t(e.target);if(i.hasClass("xt_video_player_common_active"))return!1;a=t(e.target).data("speed"),this.$video.trigger("speed.change",{old_speed:this.video.playbackRate,new_speed:a}),s.html(i.html()),this.video.playbackRate=a,this.util.saveState.call(this,{speed:a}),i.addClass("xt_video_player_common_active").siblings().removeClass("xt_video_player_common_active")}.bind(this)),this.$video.on("quality.changed",function(e){this.$video.on("loadedmetadata",function(){this.video.playbackRate=a}.bind(this))}.bind(this))},i.prototype.progress=function(){if(this.options.isShowProgress)var e=t('<div class="xt_video_player_progress"><div class="xt_video_player_progress_bufferTime"></div><div class="xt_video_player_progress_currentTime"></div><div class="xt_video_player_seek_handle_wrap"><div class="xt_video_player_seek_handle"><div class="xt_video_player_seek_handle_inner"></div></div></div></div>').appendTo(this.$controls);else var e=t('<div class="xt_video_player_progress" style="display: none;opacity: 0;"></div>').appendTo(this.$controls);var i=e.find(".xt_video_player_progress_currentTime"),n=e.find(".xt_video_player_progress_bufferTime"),o=this.$seekHandleWrap=e.find(".xt_video_player_seek_handle_wrap"),s=e.find(".xt_video_player_seek_handle"),a=0;this.options.isDrag||(i.addClass("no_drag"),n.addClass("no_drag"),o.addClass("no_drag"),s.addClass("no_drag")),this.$video.on("loadedmetadata.process",function(){a=this.options.startTime||this.options.position||this.video.currentTime,this.$video.off("loadedmetadata.process")}.bind(this)),function(){var n=0,r=0;e.off("click"),e.on("click",function(e){if(n=this.$video.offset().left,r=a/this.video.duration*parseInt(o.width()),this.options.isDrag||e.pageX-n-r<=0){s.css({left:e.pageX-n}),i.css({width:e.pageX-n});var t=(e.pageX-n)/this.$video.width(),d=this.video.duration*t;(this.options.isDrag||d-this.video.currentTime<=0)&&(this.$video.trigger("xt.progress.seek",{old_time:this.video.currentTime,new_time:d,type:"onSlideSeek"}),this.video.currentTime=d,this.$video.trigger("playBtn.toggle",{type:"play"}))}}.bind(this));var d=0,c=function(e){var t=0,a=e.pageX-n;a>0&&(t=a>parseInt(o.width())?parseInt(o.width()):a),(this.options.isDrag||t-r<=0)&&(s.css({left:t}),i.css({width:t}))}.bind(this);s.on({mousedown:function(e){e.stopPropagation(),this.options.isDrag&&this.$video.trigger("playBtn.toggle",{type:"pause"}),d=!0,n=o.offset().left,r=a/this.video.duration*parseInt(o.width()),t(document).on("mousemove",c)}.bind(this),click:function(e){e.stopPropagation()}}),t(document).on({mouseup:function(e){if(e.stopPropagation(),d){t(document).off("mousemove",c);var i=(e.pageX-n)/parseInt(o.width());i>1&&(i=1);var s=i*this.video.duration;(this.options.isDrag||s-this.video.currentTime<=0)&&this.$video.trigger("xt.progress.seek",{old_time:this.video.currentTime,new_time:s,type:"onSlideSeek"}),this.video.currentTime=s,this.$video.trigger("playBtn.toggle",{type:"play"}),d=!1}}.bind(this)})}.bind(this)(),this.$video.on("timeupdate.process",function(e){this.options.isDrag?a=this.video.currentTime:this.video.currentTime-a<2?this.video.currentTime-a>0&&(a=this.video.currentTime):this.video.currentTime=a;var t=this.video.currentTime/this.video.duration*100,r=t+"%";i.css({width:r}),s.css({left:r}),t>=96&&!this.options.isDrag&&(this.options.isDrag=!0,i.removeClass("no_drag"),n.removeClass("no_drag"),o.removeClass("no_drag"),s.removeClass("no_drag"))}.bind(this)),this.$video.on("progress",function(e){if(this.buffered.length<1)return!1;var t=this.buffered.end(0)/this.duration*100+"%";n.css({width:t})})},i.prototype.quality=function(){var e=this;if(!this.options||!this.options.quality||!this.options.quality.show||!t.isArray(this.options.quality.src)||this.options.quality.src.length<2)return!1;var i="",n="";this.options.quality.src.forEach(function(t){t.default?(i+='<li class="xt_video_player_common_active">'+(e.i18n[t.name]?e.i18n[t.name]:t.name)+"</li>",n=e.i18n[t.name]?e.i18n[t.name]:t.name):i+="<li>"+(e.i18n[t.name]?e.i18n[t.name]:t.name)+"</li>"}),n||this.options.quality.src.forEach(function(t){t.val==this.$video.attr("src")&&(n=e.i18n[t.name]?e.i18n[t.name]:t.name)});var o=t('<div class="xt_video_player_quality xt_video_player_common fr"><div class="xt_video_player_common_value">'+n+'</div><ul class="xt_video_player_common_list">'+i+"</ul></div>").appendTo(this.$controls),s=o.find(".xt_video_player_common_list"),a=o.find(".xt_video_player_common_value");s.find("li").on({click:function(e){var i=t(e.target);if(i.hasClass("xt_video_player_common_active"))return!1;a.html(i.html()),i.addClass("xt_video_player_common_active").siblings().removeClass("xt_video_player_common_active");var n=this.video.currentTime;this.$wrap.css({height:this.$video.height()}),this.$video.trigger("quality.change",{quality:i.html()}),this.$video.attr({src:this.options.quality.src[i.index()].val}),this.$video.trigger("quality.changed",{quality:i.html()});var o=function(e){this.video.currentTime=n,this.$video.trigger("playBtn.toggle",{type:"play"}),this.$video.off("loadedmetadata",o)}.bind(this);this.$video.on("loadedmetadata",o)}.bind(this)}),o.on({mouseover:function(){s.show()},mouseout:function(){s.hide()}})},i.prototype.caption=function(){if(!this.options)return!1;if(this.options.multiplySyncVideo.src)return!1;var e=this.options.caption;if(!e||!e.src)return!1;t.isArray(e.src)||(e.src=[e.src]);var i=function(e,t){var i,n=t.start,o=t.end,s=t.text.length-1,a=0;if((e*=1e3)<n[a])return-1;for(;a<s;)i=Math.ceil((s+a)/2),e<n[i]&&(s=i-1),e>=n[i]&&(a=i);return e>=o[a]?-1:a},n="",o=function(e){var i=t.Deferred();return t.ajax({url:e.src,dataType:"json",notifyOnError:!1}).done(function(e){i.resolve(e)}).fail(function(n){t.ajax({url:e.availableSrc,dataType:"json",notifyOnError:!1}).done(function(e){i.resolve(e)}).fail(function(e){i.reject(),console.error(n,e,"caption fetch fail")})}),i.promise()};e.src.every(function(e){return!e.default||(n=e,!1)}),n||(n=e.src[0]);var s=null,a=null,r=null,d=null,c=0,l=function(n){s=n;var o=t('<div class="xt_video_player_caption xt_video_player_hide"><div>').appendTo(this.$controls);e.show&&this.$video.trigger("caption.initDown"),this.$video.on({timeupdate:function(){var e=i(this.video.currentTime,s);if(this.$video.trigger("caption.scrollAside",e),e<0||/^\s*$/.test(s.text[e]))return o.hide(),!1;o.html(s.text[e]).show()}.bind(this)})}.bind(this);this.$video.on("loadedmetadata",function(){c=this.$video.height()/2}.bind(this)),this.$video.on("caption.initAside",function(){this.$wrap.width("70%"),t.fullscreen.isFullScreen()||(c=this.$video.height()/2);var e="";s.text.forEach(function(t){/^\s*$/.test(t)&&(t="..."),e+="<li>"+t+"</li>"}),a=t('<div class="xt_video_player_caption_aside" style="width: 30%;"><ul style="padding: 50% 0;">'+e+"</ul></div>").appendTo(this.$container),r=a.find("ul"),d=a.find("li").on("click",function(e){var i=t(e.target).index(),n=s.start[i]/1e3;this.$video.trigger("xt.progress.seek",{old_time:this.video.currentTime,new_time:n,type:"onCaptionSeek"}),this.video.currentTime=n,this.$video.trigger("playBtn.toggle",{type:"play"})}.bind(this))}.bind(this)),this.$video.on("caption.scrollAside",function(){var e=null;return function(t,i){if(i<0||!a||!a.length)return!1;e=i;var n=d.removeClass("xt_video_player_caption_active").eq(i).addClass("xt_video_player_caption_active");a.scrollTop(n.get(0).offsetTop-c)}.bind(this)}()),this.$video.on("caption.removeAside",function(){if(a){a.remove();this.$wrap.width();this.$wrap.css("width","100%"),a=null}}.bind(this)),this.$video.on("caption.hasAside",function(e,t){a&&a.length?t.hasAside=!0:t.hasAside=!1}.bind(this)),this.$video.on("caption.removeDown",function(){this.$controls.find(".xt_video_player_caption").addClass("xt_video_player_hide")}.bind(this)),this.$video.on("caption.initDown",function(){this.$controls.find(".xt_video_player_caption").removeClass("xt_video_player_hide")}.bind(this)),n&&n.src&&o(n).done(l).fail(function(){this.$video.trigger("captionBtn.removeLangBtn");var t=null;Array.isArray(e.src)&&e.src.length>1&&e.src.every(function(e,i,n){return!!e.default||(t=e,!1)}),t?o(t).done(l).fail(function(){this.$video.trigger("captionBtn.remove")}.bind(this)):this.$video.trigger("captionBtn.remove")}.bind(this)),this.$video.on("caption.change",function(e,t){s=t})},i.prototype.captionBtn=function(){var e=this;if(!this.options)return!1;var i=this.options.caption;if(!i||!i.src||!i.src.length)return!1;t.isArray(i.src)||(i.src=[i.src]);var n="";i.src.length>1&&i.src.forEach(function(t){t.default?n+='<li data-src="'+t.src+'" data-avaliblesrc="'+t.availableSrc+'" class="xt_video_player_common_active">'+(e.i18n[t.name]?e.i18n[t.name]:t.name)+"</li>":n+='<li data-src="'+t.src+'" data-avaliblesrc="'+t.availableSrc+'">'+(e.i18n[t.name]?e.i18n[t.name]:t.name)+"</li>"});var o="";if(i.src.length>0&&(i.show?(o+='<li data-type="aside" class="xt_video_player_word_break">'+e.i18n["右侧"]+"<br />"+e.i18n["字幕"]+"</li>",o+='<li data-type="down" class="xt_video_player_common_active xt_video_player_word_break">'+e.i18n["下方"]+"<br />"+e.i18n["字幕"]+"</li>"):(o+='<li data-type="aside" class="xt_video_player_word_break">'+e.i18n["右侧"]+"<br />"+e.i18n["字幕"]+"</li>",o+='<li data-type="down" class="xt_video_player_word_break">'+e.i18n["下方"]+"<br />"+e.i18n["字幕"]+"</li>")),!o&&!n)return!1;var s=t('<div class="xt_video_player_caption_btn xt_video_player_common fr"><div class="xt_video_player_common_value">'+e.i18n["字幕"]+'</div><ul class="xt_video_player_common_list">'+o+n+"</ul><div>").appendTo(this.$controls).on({mouseover:function(){a.show()}.bind(this),mouseout:function(){a.hide()}.bind(this)}),a=s.find("ul");a.find("[data-type]").on("click",function(e){var i=t(e.target);"aside"===i.data("type")?i.hasClass("xt_video_player_common_active")?(this.$video.trigger("caption.removeAside"),i.removeClass("xt_video_player_common_active")):(this.$video.trigger("caption.removeDown"),a.find("[data-type]").removeClass("xt_video_player_common_active"),this.$video.trigger("caption.initAside"),i.addClass("xt_video_player_common_active")):i.hasClass("xt_video_player_common_active")?(this.$video.trigger("caption.removeDown"),i.removeClass("xt_video_player_common_active")):(this.$video.trigger("caption.removeAside"),a.find("[data-type]").removeClass("xt_video_player_common_active"),this.$video.trigger("caption.initDown"),i.addClass("xt_video_player_common_active"))}.bind(this));var r=function(e){this.$video.trigger("caption.change",e);var t={};this.$video.trigger("caption.hasAside",t),i.show&&t.hasAside&&(this.$video.trigger("caption.removeAside"),this.$video.trigger("caption.initAside"))}.bind(this),d=a.find("[data-src]").on("click",function(e){var i=t(e.target);if(i.hasClass("xt_video_player_common_active"))return!1;var n=function(){d.removeClass("xt_video_player_common_active"),i.addClass("xt_video_player_common_active")},o=i.html();"中文"===o||"Chinese"===o?o="chinese":"英文"!==o&&"English"!==o||(o="english"),this.$video.trigger("caption.lang.change_xt",{lang:o.toLowerCase()}),t.ajax({url:i.data("src"),dataType:"json",notifyOnError:!1}).done(function(e){r(e),n()}.bind(this)).fail(function(e){t.ajax({url:i.data("avaliblesrc"),dataType:"json",notifyOnError:!1}).done(function(e){r(e),n()}.bind(this)).fail(function(t){console.error(e,t,"fetch caption fail!")})}.bind(this))}.bind(this));this.$video.on("captionBtn.remove",function(){s.length&&s.remove()}),this.$video.on("captionBtn.asideHide",function(){if(s.length){var e=s.find('[data-type="aside"]');e.length&&e.hide()}}),this.$video.on("captionBtn.asideShow",function(){if(s.length){var e=s.find('[data-type="aside"]');e.length&&e.show()}}),this.$video.on("captionBtn.removeLangBtn",function(){d.remove()})},i.prototype.startAndEnd=function(){this.options.startTime&&this.$video.on("loadedmetadata.starttime",function(){var e=Math.round(10*this.video.duration)/10,t=this.options.startTime;e-this.options.startTime<=5&&(t=0),this.video.currentTime=t,this.$video.off("loadedmetadata.starttime")}.bind(this)),this.options.endTime&&this.$video.on("timeupdate.enttime",function(){this.video.currentTime>=parseInt(this.options.endTime)&&this.video.load()}.bind(this))},i.prototype.download=function(){if(!this.options.download.show||!this.options.download.src||!this.options.download.src.length)return!1;var e=this.options.download.src,i=t(e).insertAfter(this.$container),n=i.find(".video-tracks .a11y-menu-container"),o=i.find(".a11y-menu-button").on("click",function(e){e.preventDefault()});n.on({mouseover:function(){t(this).addClass("open")},mouseout:function(){t(this).removeClass("open")}}),n.find(".a11y-menu-item-link").on("click",function(e){var i=t(e.target),n=i.data("value");o.html("."+n),i.parent().addClass("active").siblings().removeClass("active"),this.util.saveState.call(this,{transcript_download_format:n})}.bind(this))},i.prototype.resurrect=function(){var e=null;this.$video.on("emptied.err",function(){}.bind(this)),this.$video.on("timeupdate.err",function(){clearTimeout(e),e=setTimeout(function(){var e={};this.$video.trigger("loader.isShow",e),this.video.paused||e.isShow||(this.video.currentTime=this.video.currentTime-.1)}.bind(this),3e3)}.bind(this))},i.prototype.multiplySyncVideo=function(){var e=this.$container.find(".xt_video_player_multiply_sync_video video");if(!e.length)return!1;var i=(e.add(this.$video),this.$video);if(i.on("play",function(){e.get(0).play()}),i.on("pause",function(){e.get(0).pause()}),i.on("waiting",function(){e.get(0).pause();var t=function(n){e.get(0).play(),i.off("canplay",t),i.off("playing",t),e.get(0).currentTime=i.get(0).currentTime};i.on("canplay playing",t)}),setInterval(function(){if(i.get(0).paused)return!1;e.get(0).currentTime=i.get(0).currentTime},1550),this.options.multiplySyncVideo.mainPoint.length){var n=function(e){return e*=1,parseInt(e/60)+":"+parseInt(e%60)},o='<div class="xt_video_player_main_point"><h2>'+this.i18n["知识要点"]+'</h2><div class="main_point_item_wrap">';this.options.multiplySyncVideo.mainPoint.forEach(function(e,t){o+='<div class="main_point_item" data-time="'+e.time+'"><span style="color:blue;">'+n(e.time)+"</span>&nbsp;&nbsp;&nbsp;&nbsp;"+e.value+"</div>"}),o+="</div></div>",t(o).appendTo(this.$container.find(".xt_video_player_multiply_sync_video")).find(".main_point_item").on("click",function(e){i.get(0).currentTime=t(this).data("time")})}},i.prototype.CDNlog=function(){var e=this,i=["loadstart","progress","suspend","abort","error","emptied","stalled","play","pause","loadedmetadata","loadeddata","waiting","playing","canplay","canplaythrough","seeking","seeked","timeupdate","ended","ratechange","durationchange","volumechange"];t.each(i,function(t,i){!function(t){e.$video.on(t+".cdnlog",function(){e.$video.trigger("html5:"+t,arguments)})}(i)})},i.prototype.contextMenu=function(){this.$video.on("contextmenu",function(e){return e.preventDefault(),!1})},i.prototype.log=function(){var e=this;if(!this.options.log)return!1;var i=function(i,n,o){o=!o;var s={};s.event_type=i,s.page=location.href,n||(n={}),this.options.id||console.error("video-id is empty! The log function is disabled!"),n.id=this.options.id,n.code="html5",n.currentTime=this.video.currentTime||0,this.options.cid?n.cid=this.options.cid:(t.md5||(console.info("cid param is undefined! so cid is got from url."),this.util.md5()),n.cid=t.md5(location.host+location.pathname),n.pathname=location.host+location.pathname),s.event=JSON.stringify(n),t.extend(s.event,n||{}),e.util._ajax({url:"/event",type:"post",async:o,data:s})}.bind(this);this.$video.on("play.log",function(){i("play_video")}),this.$video.on("error.log",function(){i("load_video_error")}),this.$video.on("waiting.log",function(){i("waiting_video")}),this.$video.on("pause.log",function(){i("pause_video")});var n=!1;this.$video.on("volumechange.log",function(){if(!n)return n=!0,!1;i("volume_change_video",{volume:this.volume})}),this.$video.on("loadedmetadata.log",function(){i("load_video")}),this.$video.on("ended.log",function(){i("stop_video")}),this.$video.on("speed.change",function(e,t){i("speed_change_video",t)}),this.$video.on("caption.initAside",function(e){i("show_transcript")}),this.$video.on("caption.removeAside",function(e){i("hide_transcript")}),this.$video.on("caption.lang.change_xt",function(e,t){i("caption_lang_change_video",t)}),this.$video.on("caption.removeDown",function(){i("hide_transcript_bottom")});var o=!1;this.$video.on("caption.initDown",function(){if(!o)return o=!0,!1;i("show_transcript_bottom")}),this.$video.on("quality.change",function(e,t){"高清"===t.quality||"HD"==t.quality?t.quality="HD":t.quality="ND",i("quality_change_video",t)}),this.$video.on("xt.progress.seek",function(e,t){i("seek_video",t)}),this.$video.on("captionBtn.asideHide",function(){i("fullscreen_video")}),this.$video.on("captionBtn.asideShow",function(){i("cancel_fullscreen_video")}),t(window).on("beforeunload",function(){i("pause_video",{},!0)})},i.prototype.quiz=function(){if(!this.options.quiz)return!1;var e=[],i=[];for(var n in this.options.quiz)e.push(this.util.timeFormat(this.options.quiz[n])),i.push(n);var o=null,s=null,a=null,r=null,d=this.$container.parents(".xblock").eq(0).data("runtime-class")||"",c="lms";-1===d.toLowerCase().indexOf("lms")&&(c="cms");var l=function(e){if(!1===e)s.find(".indicator_container .status").removeClass("correct").addClass("incorrect");else for(n in e)s.find("#inputtype_"+n+" .indicator_container .status").removeClass("correct incorrect").addClass(e[n])};this.$video.on("timeupdate",function(n){var d=parseInt(this.video.currentTime);if(-1!==e.indexOf(d)){if(o===d)return!1;o=d,this.$video.trigger("playBtn.toggle",{type:"pause"}),this.$video.one("play",function(e){s.remove(),u.abort()});var l='<div class="xt_video_player_quiz_container"><div class="xt_video_player_quiz_container_inner loading"><div class="xblock xblock-student_view xmodule_display xmodule_CapaModule xblock-initialized" > <div class="problems-wrapper" ></div><div class="xt_video_player_quiz_btn cf" style="display: none;"><p class="fl incorrect-message"></p><a id="xt_video_player_quiz_skip" href="javascript:">'+this.i18n["跳过"]+'</a><a id="xt_video_player_quiz_submit" href="javascript:">'+this.i18n["提交"]+"</a></div> </div></div></div>";s=t(l),this.$controls.addClass("xt_video_player_controls_show"),this.$container.append(s),a=i[e.indexOf(d)],r=s.find(".incorrect-message");var u=t.ajax({url:"lms"===c?"/courses/"+this.options.cid+"/xblock/"+a+"/handler/xmodule_handler/problem_get":"/preview/xblock/"+a+"/handler/xmodule_handler/problem_get",type:"post",data:{render_state:!1},dataType:"json"}).done(function(e){s.find(".xt_video_player_quiz_container_inner").removeClass("loading");var i=t(e.html);i.find("input").each(function(){var e=t(this),i=e.attr("id");e.attr("id",i+"abc").attr("_id",i)}),i.find("label").each(function(){var e=t(this),i=e.attr("for");e.attr("for",i+"abc")}),s.find(".problems-wrapper").append(i),s.find(".xt_video_player_quiz_btn").show()}.bind(this)).fail(function(e){this.$video.trigger("playBtn.toggle",{type:"play"}),console.error(e)}.bind(this))}else o=null}.bind(this)),this.$video.on("loadedmetadata.quiz",function(){setTimeout(function(){var t=this.video.duration;e.forEach(function(e){var i=e/t*100;this.$seekHandleWrap.prepend('<span class="xt_video_player_quiz_timepoint" style="left: '+i+'%"></span>')}.bind(this))}.bind(this),200)}.bind(this)),t(document).on("click","#xt_video_player_quiz_skip",function(){this.$video.trigger("playBtn.toggle")}.bind(this)),t(document).on("click","#xt_video_player_quiz_submit",function(e){var i=t(e.target);if(i.hasClass("waiting"))return!1;var n=s.find("form").serialize();n?(i.html(this.i18n["正在提交..."]).addClass("waiting"),t.ajax({url:"lms"===c?"/courses/"+this.options.cid+"/xblock/"+a+"/handler/xmodule_handler/quiz_problem_check":"/preview/xblock/"+a+"/handler/xmodule_handler/quiz_problem_check",data:n,type:"post",dataType:"json"}).done(function(e){if("correct"==e.success){l(e.result),i.html(this.i18n["继续播放"]),r.removeClass("xt_video_player_quiz_incorrect_msg").html(this.i18n["回答正确！学霸君，棒棒哒！"]);var t=setTimeout(function(){this.$video.trigger("playBtn.toggle")}.bind(this),3e3);i.off("click").on("click",function(){this.$video.trigger("playBtn.toggle"),clearTimeout(t)}.bind(this))}else l(e.result),r.html(this.i18n["回答错误，别气馁，再试一次！"]).addClass("xt_video_player_quiz_incorrect_msg"),i.html(this.i18n["重新提交"])}.bind(this)).fail(function(e){console.error(e),i.html(this.i18n["重新提交"]),r.html(this.i18n["提交失败，再试一次！"]).addClass("xt_video_player_incorrect_msg")}).always(function(){i.removeClass("waiting")})):l(!1)}.bind(this)),t(document).on("fscreenchange",function(){t.fullscreen.isFullScreen()?s.find(".problem").css({height:"auto"}):s.find(".problem").css({height:"290px"})}.bind(this))},i.prototype.question=function(){var e,i=this;if(!this.options.id||this.options.hiddenQuestion)return!1;var n=location.pathname.match(/^\/courses\/(.*)/),o=n?n[1]:"";o=-1!==o.indexOf("/_/")?o.split("/_")[0]+"/_":o.split("/")[0];var s={video_id:this.options.id,course_id:o};if(i.util._ajax({type:"GET",url:"/courses/questions/",async:!1,data:s,success:function(t){e=t},error:function(){console.log("xm数据请求失败")}}),e&&e.success&&e.data.question_list){t('<div id="robot_question_wrap"><div>').appendTo(t(".xt_video_player_container")).css({height:"50px",display:"none",position:"absolute",top:"0px",left:"10px",fontSize:"14px",marginTop:"10px"}).append(t('<div id="xm_head"></div>').css({position:"absolute",top:"0px",left:"0px",width:"44px",height:"50px",background:"url(//storage.xuetangx.com/public_assets/xuetangx/images/xiaomuofhead1.png) center center no-repeat",zIndex:"1"})).append(t('<div id="question_text_wrap"></div>').css({position:"relative",cursor:"pointer",background:"rgba(0,0,0,0.6)",height:"30px",paddingTop:"0.1px",margin:"13px 0 0 26px",borderTopRightRadius:"17px",borderBottomRightRadius:"17px",border:"1px solid #575454"}).append(t('<p id="question_text"></p>').css({height:"18px",cursor:"pointer",lineHeight:"18px",borderRight:"1px solid #3c3c3c",margin:"6px 30px 0 11px",color:"#FFF",paddingRight:"2px"}))),t('<p id="robot_question_close"></p>').appendTo(t("#robot_question_wrap")).css({position:"absolute",right:"-18px",top:"0",borderRadius:"50%",display:"block",background:"rgba(0,0,0,0.6) url(//storage.xuetangx.com/public_assets/xuetangx/images/robot_question_close.png) center center no-repeat",backgroundSzie:"6px 6px",width:"16px",height:"16px",cursor:"pointer"}),t('<div id="praise"></div>').appendTo(t("#question_text_wrap")).css({position:"absolute",top:"6px",right:"7px",width:"16px",height:"16px",background:"url(//storage.xuetangx.com/public_assets/xuetangx/images/praise1.png) center center no-repeat",backgroundSize:"contain",cursor:"pointer"});var a={course_id:o,video_id:this.options.id,question_id:"",type:""};t("#praise").on("click",function(){var n=t("#question_text").html().split("：")[1];t.each(e.data.question_list,function(e,t){t.question===n&&(t.isPraise=!0,a.question_id=t.question_id)}),a.type="1",i.util._ajax({type:"post",url:"/courses/questions/",data:a,success:function(e){},error:function(){}})}),t("#robot_question_close").on("click",function(){var n=t("#question_text").html().split("：")[1];t.each(e.data.question_list,function(e,t){t.question===n&&(t.hide=!0,a.question_id=t.question_id)}),a.type="0",i.util._ajax({type:"post",url:"/courses/questions/",data:a,success:function(e){},error:function(){}})}),this.$video.on("timeupdate",function(i){var n=parseInt(this.currentTime);t.each(e.data.question_list,function(e,i){if(i.isPraise?t("#praise").css({background:"url(//storage.xuetangx.com/public_assets/xuetangx/images/praise2.png) center center no-repeat",backgroundSize:"contain"}):t("#praise").css({background:"url(//storage.xuetangx.com/public_assets/xuetangx/images/praise1.png) center center no-repeat",backgroundSize:"contain"}),!i.hide&&n>=i.start&&n<=i.end){if(t("#robot_question_wrap").css({display:"block"}).attr({show:1}),i.true_question)var o=i.true_question.replace(/\(.*\)/,"");else var o=i.question.replace(/\(.*\)/,"");return t("#question_text").text(i.question).attr("question",o).attr("cur_time",n).attr("question_id",i.question_id),!1}t("#robot_question_wrap").css({display:"none"}).attr({show:0})})})}},i.prototype.knowledge_navigation=function(){function e(e){return parseInt(e/60)+":"+(e%60<10?"0"+e%60:e%60)}var i,n=this;if(!this.options.id||this.options.hiddenKnowledgePoint)return!1;var o=this.video.duration;if(n.util._ajax({type:"GET",url:"/courses/knowledge_navigation/",async:!1,data:"video_id="+this.options.id,success:function(e){i=e},error:function(){console.log("失败")}}),o&&i&&i.success&&i.data.breakpoint){var s=i.circle_size,a="rgba(142, 170,252, 0)";"big"==s&&(a="rgba(142, 170,252, 1)"),t.each(i.data.breakpoint,function(i,s){var r=s.time/o*100+"%",d=e(s.time);t('<span id="point_text_'+i+'" class="point_text"></span>').css({position:"absolute",display:"none",top:"-23px",width:"auto",height:"24px",lineHeight:"24px",color:"#fff",whiteSpace:"nowrap",color:"white",padding:"0 8px",background:"rgba(0,0,0,0.6)",borderRadius:"3px"}).appendTo(t('<div class="point_wrap"></div>').html('<div class="point" style="position:absolute; width:8px; border-radius:4px; height:8px; background:#8EAAFC; cursor:pointer;top:4px;left:4px;"></div>').css({position:"absolute",width:"16px","border-radius":"8px",height:"16px",background:a,cursor:"pointer",top:"-5px"}).appendTo(t(".xt_video_player_progress")).addClass("point"+i).hover(function(){t(".xt_video_player_caption").css({top:"-37px"}),t(this).find(".point_text").css({display:"block"})},function(){t(".xt_video_player_caption").css({top:"-7px"}),t(this).find(".point_text").css({display:"none"})}).on("mouseover",function(){var e=n.$video.parent().parent().width(),i=t(this).find("span.point_text").width()/2,o=t(this).position().left,s=e-o-16;i<o&&i<s?t(this).find("span").css({left:-i+"px"}):i>o?t(this).find("span").css({left:-o+"px"}):i>s&&t(this).find("span").css({left:-s+"px"})}).on("click",function(e){n.$video.trigger("xt.progress.seek",{old_time:n.video.currentTime,new_time:s.time,type:"onNavigationPoin"})})).html(d+" "+s.text),t(".point"+i).css({left:r})})}},i.prototype.heartlog=function(){function e(e,t,n,o,s,a){var r={event_type:"cdn_perf",page:window.location.href,event:JSON.stringify({event:o,id:e,expgroup:t,value:n,page:s,count:a})};i.options.isHeart&&i.util._ajax({type:"POST",url:"/event",data:r,success:function(e){}})}var i=this;if(!i.options.id||!i.options.isHeart)return!1;var n,o={},s=Math.floor(1048576*(1+Math.random())).toString(36);if(i.$video.length>0){var a=i.options.heartSrc?i.options.heartSrc+"?":"//log.xuetangx.com/heartbeat?",r={api:a,seq:0,initialed:!1,$videoEle:null,videoEle:null,get_params_rate:2,heart_beat_rate:5,get_params_timer:null,send_params_timer:null,isloaded:!1,iscanpaly:!1,isInitSeeking:!1,params:{i:5,et:"",p:"web",cp:0,fp:0,tp:0,sp:1,ts:0,u:"",c:"",v:i.options.id,cc:i.options.cc,d:0,pg:i.options.id+s,sq:0},init:function(e){var n=this;if(n.initialed)return!1;window.c=function(){},n.initialed=!0,n.params.u=i.options.userId||"",t.md5||(console.info("init $.md5"),i.util.md5()),this.params.c||(this.params.c=i.options.cid?i.options.cid:t.md5(location.host+location.pathname)),this.params.c&&this.bindEvent()},resetTimer:function(){var e=this;e.clearTimer(),e.sqTemp=0,e.dTemp=Math.round(10*i.video.currentTime)/10,e.send_params_timer=setInterval(e.sendHeartParams.bind(e),1e3*e.heart_beat_rate)},clearTimer:function(){var e=this;e.send_params_timer&&clearInterval(e.send_params_timer)},bindEvent:function(){var e=this;i.$video.on("loadedmetadata.heartbeat",function(){e.isloaded=!0;var t=i.options.duration?i.options.duration:i.video.duration;i.options.duration=t,e.params.d=Math.round(10*t)/10,!e.isInitSeeking&&i.options.autoplay&&(i.options.startTime||i.options.position)&&(e.isInitSeeking=!0,e.getParams(i.options.startTime||i.options.position),e.params.et="seeking",e.sendEvents())}),i.$video.on("canplay.heartbeat",function(){e.iscanpaly=!0}),i.$video.on("heartbeatPlay",function(){e.params.et="play",e.resetTimer(),e.isloaded&&e.iscanpaly&&(e.getParams(),e.sendEvents())}),i.$video.on("play.heartbeat",function(){i.$video.trigger("heartbeatPlay")}),i.$video.on("pause.heartbeat",function(){e.clearTimer(),e.isloaded&&e.iscanpaly&&(e.params.et="pause",e.getParams(),e.sendEvents())}),i.$video.on("xt.progress.seek",function(t,i){t.stopPropagation(),e.isloaded&&(e.params.fp=i.old_time,e.params.cp=e.params.tp=i.new_time,e.params.et="seeking",e.sendEvents())}),i.$video.on("ended.heartbeat",function(){e.clearTimer(),e.isloaded&&e.iscanpaly&&(e.params.et="videoend",e.getParams(),e.sendEvents())}),i.$video.on("ratechange.heartbeat",function(){e.params.sp=i.video.playbackRate})},getParams:function(e){var t=this,n=i.options.duration?i.options.duration:i.video.duration;t.params.d=Math.round(10*n)/10,t.params.cp=e||Math.round(10*i.video.currentTime)/10,t.params.sp=i.video.playbackRate},sendEvents:function(){var e=this;e.params.sq++,e.params.fp=Math.round(10*e.params.fp)/10,e.params.tp=Math.round(10*e.params.tp)/10,e.params.ts=Date.now?Date.now():(new Date).getTime(),e.params.d<=0&&(e.params.d=Math.round(10*i.video.duration)/10);var t=e.api+e.buildUrl(e.params);i.options.isHeart&&e.params.d>0&&e.params.cp>=0&&e.params.cp<1/0&&e.params.fp>=0&&e.params.tp>=0&&e.params.tp<1/0&&i.util._ajax({type:"GET",url:t,timeout:3e3,success:function(e){},error:function(e,t,i){}})},buildUrl:function(e){var t=[];for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return t.join("&")},sendHeartParams:function(){var e=this;e.params.et="heartbeat",e.isloaded&&e.iscanpaly&&(0==t(".xt_video_player").length?(e.clearTimer(),e.params.et="pause",e.getParams(),e.sendEvents()):(e.params.cp=Math.round(10*i.video.currentTime)/10,e.getParams(Math.round(10*i.video.currentTime)/10),e.sendEvents()))}};!function(){var a="newcloud-bokecc";-1!=r.api.indexOf("zyk.xuetangx.com")&&(a="zyk-bokecc"),e(i.options.id+s,a,"","load",r.params.cc,1),n=Date.now(),t.each(["loadstart","abort","error","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","seeked"],function(t,d){i.$video.bind("html5:"+d,null,function(){var t=Date.now()-n;d in o?o[d]++:o[d]=1,e(i.options.id+s,a,t,d,r.params.cc,o[d])})})}(),r.init()}},t.fn.xtVideo=function(e){return this.each(function(){new i(t(this),e)})}}(e)}).call(t,i(47))}});